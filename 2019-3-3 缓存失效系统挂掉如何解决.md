---
title: 2019-3-3 缓存失效系统挂掉如何解决
tags: 
grammar_cjkRuby: true
---

### 高并发与缓存
**tips:高并发系统架构口诀：读多写少用缓存，写多读少用队列**

### 缓存失效两种情况
* 高峰期大面积缓存key失效
* 局部高峰期，热点缓存key失效
![enter description here][1]
### 缓存雪崩
因为缓存服务挂掉或者热点缓存失效，从而导致所有请求都去查数据库，导致数据库连接不够用或者数据库处理不过来，从而导致整个系统不可用；
数据库服务器压力大，依赖数据库的其他系统也会面临崩溃风险
![enter description here][2]

### 增加互斥锁
![enter description here][3]
### 锁方案得优缺点
#### 优点：
* 简单有效
* 适用范围广
#### 缺点：
* 锁阻塞其他线程，导致用户体验不好
* 锁的颗粒度太粗。所有缓存重建请求被一把锁阻塞。（不同车次实现单独的锁）


  [1]: ./images/1551601257960.jpg "1551601257960.jpg"
  [2]: ./images/1551601389714.jpg "1551601389714.jpg"
  [3]: ./images/1551602347951.jpg "1551602347951.jpg"